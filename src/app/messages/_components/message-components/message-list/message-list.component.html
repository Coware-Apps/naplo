<ng-container *ngIf="componentState.value == 'loaded'">
    <ion-refresher
        slot="fixed"
        (ionRefresh)="loadMessages(true, $event)"
        pullFactor="0.8"
        pullMin="60"
        pullMax="120"
    >
        <ion-refresher-content></ion-refresher-content>
    </ion-refresher>

    <ion-list>
        <ion-item
            *ngFor="let m of displayedMessages"
            class="message"
            [class.unread]="!m.isElolvasva"
            button
        >
            <ion-label>
                <span class="ion-float-right">
                    <small>
                        {{
                            m.uzenetKuldesDatum.toLocaleDateString(config.locale, {
                                month: "short",
                                day: "numeric"
                            })
                        }}
                    </small>
                    <div *ngIf="m.hasCsatolmany" class="ion-text-right">
                        <ion-icon name="attach-outline"></ion-icon>
                    </div>
                </span>
                <h2>
                    <ng-container *ngIf="m.uzenetFeladoNev">
                        {{ m.uzenetFeladoNev }} <small>({{ m.uzenetFeladoTitulus }})</small>
                    </ng-container>
                    <ng-container *ngIf="m.uzenetCimzettLista">
                        <ng-container
                            *ngIf="m.uzenetCimzettLista.length == 1; else multipleRecipients"
                        >
                            {{ m.uzenetCimzettLista[0].nev }}
                            <small> ({{ m.uzenetCimzettLista[0].tipus.rovidNev }})</small>
                        </ng-container>
                        <ng-template #multipleRecipients>
                            {{ m.uzenetCimzettLista[0].nev }}
                            <small> és {{ m.uzenetCimzettLista.length - 1 }} további címzett</small>
                        </ng-template>
                    </ng-container>
                </h2>
                <p>{{ m.uzenetTargy }}</p>
            </ion-label>
        </ion-item>
    </ion-list>

    <ion-button
        (click)="loadMoreData()"
        expand="block"
        fill="clear"
        *ngIf="toBeDisplayed.length > 0"
    >
        Több üzenet betöltése
    </ion-button>

    <ion-infinite-scroll threshold="100px" (ionInfinite)="loadMoreData($event)">
        <ion-infinite-scroll-content
            loadingSpinner="bubbles"
            loadingText="További üzenetek betöltése..."
        >
        </ion-infinite-scroll-content>
    </ion-infinite-scroll>
</ng-container>

<ion-grid class="list-empty" *ngIf="componentState.value == 'empty'">
    <ion-row class="ion-text-center ion-align-items-center">
        <ion-col>
            <ion-icon name="file-tray-outline"></ion-icon>
            <h3>Nincs üzenet a mappában</h3>
        </ion-col>
    </ion-row>
</ion-grid>

<ng-container *ngIf="componentState.value == 'loading'">
    <ion-progress-bar type="indeterminate" color="warning"></ion-progress-bar>

    <ion-list>
        <ion-item>
            <ion-label>
                <h2><ion-skeleton-text width="60%" animated></ion-skeleton-text></h2>
                <p><ion-skeleton-text width="30%" animated></ion-skeleton-text></p>
            </ion-label>
        </ion-item>

        <ion-item>
            <ion-label>
                <h2><ion-skeleton-text width="20%" animated></ion-skeleton-text></h2>
                <p><ion-skeleton-text width="30%" animated></ion-skeleton-text></p>
            </ion-label>
        </ion-item>

        <ion-item>
            <ion-label>
                <h2><ion-skeleton-text width="40%" animated></ion-skeleton-text></h2>
                <p><ion-skeleton-text width="50%" animated></ion-skeleton-text></p>
            </ion-label>
        </ion-item>

        <ion-item>
            <ion-label>
                <h2><ion-skeleton-text width="35%" animated></ion-skeleton-text></h2>
                <p><ion-skeleton-text width="30%" animated></ion-skeleton-text></p>
            </ion-label>
        </ion-item>
    </ion-list>
</ng-container>

<ng-container *ngIf="componentState.value == 'error'">
    <h1>Hiba történt</h1>
</ng-container>
